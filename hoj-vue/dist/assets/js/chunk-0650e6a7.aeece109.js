(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0650e6a7"],{2155:function(s,e,a){"use strict";a.r(e);var i=function(){var s=this,e=s._self._c;return e("div",{staticClass:"setting-main"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{sm:24,md:10,lg:10}},[e("div",{staticClass:"left"},[e("p",{staticClass:"section-title"},[s._v(s._s(s.$t("m.Change_Password")))]),e("el-form",{ref:"formPassword",staticClass:"setting-content",attrs:{model:s.formPassword,rules:s.rulePassword}},[e("el-form-item",{attrs:{label:s.$t("m.Old_Password"),prop:"oldPassword"}},[e("el-input",{attrs:{type:"password"},model:{value:s.formPassword.oldPassword,callback:function(e){s.$set(s.formPassword,"oldPassword",e)},expression:"formPassword.oldPassword"}})],1),e("el-form-item",{attrs:{label:s.$t("m.New_Password"),prop:"newPassword"}},[e("el-input",{attrs:{type:"password"},model:{value:s.formPassword.newPassword,callback:function(e){s.$set(s.formPassword,"newPassword",e)},expression:"formPassword.newPassword"}})],1),e("el-form-item",{attrs:{label:s.$t("m.Confirm_New_Password"),prop:"againPassword"}},[e("el-input",{attrs:{type:"password"},model:{value:s.formPassword.againPassword,callback:function(e){s.$set(s.formPassword,"againPassword",e)},expression:"formPassword.againPassword"}})],1)],1),e("el-popover",{attrs:{placement:"top",width:"350",trigger:"click"},model:{value:s.visible.passwordSlideBlock,callback:function(e){s.$set(s.visible,"passwordSlideBlock",e)},expression:"visible.passwordSlideBlock"}},[e("el-button",{attrs:{slot:"reference",type:"primary",loading:s.loading.btnPassword,disabled:s.disabled.btnPassword},slot:"reference"},[s._v(s._s(s.$t("m.Update_Password")))]),e("slide-verify",{directives:[{name:"show",rawName:"v-show",value:!s.verify.passwordSuccess,expression:"!verify.passwordSuccess"}],ref:"passwordSlideBlock",attrs:{l:42,r:10,w:325,h:100,accuracy:3,imgs:s.imgs,"slider-text":s.$t("m.Slide_Verify")},on:{success:s.changePassword,again:function(e){return s.onAgain("password")}}}),e("el-alert",{directives:[{name:"show",rawName:"v-show",value:s.verify.passwordSuccess,expression:"verify.passwordSuccess"}],attrs:{title:s.$t("m.Slide_Verify_Success"),type:"success",description:s.verify.passwordMsg,center:!0,closable:!1,"show-icon":""}})],1)],1),e("el-alert",{directives:[{name:"show",rawName:"v-show",value:s.visible.passwordAlert.show,expression:"visible.passwordAlert.show"}],staticStyle:{"margin-top":"15px"},attrs:{title:s.visible.passwordAlert.title,type:s.visible.passwordAlert.type,description:s.visible.passwordAlert.description,closable:!1,effect:"dark","show-icon":""}})],1),e("el-col",{attrs:{md:4,lg:4}},[e("div",{staticClass:"separator hidden-md-and-down"}),e("p")]),e("el-col",{attrs:{sm:24,md:10,lg:10}},[e("div",{staticClass:"right"},[e("p",{staticClass:"section-title"},[s._v(s._s(s.$t("m.Change_Email")))]),e("el-form",{ref:"formEmail",staticClass:"setting-content",attrs:{model:s.formEmail,rules:s.ruleEmail}},[e("el-form-item",{attrs:{label:s.$t("m.Current_Password"),prop:"password"}},[e("el-input",{attrs:{type:"password"},model:{value:s.formEmail.password,callback:function(e){s.$set(s.formEmail,"password",e)},expression:"formEmail.password"}})],1),e("el-form-item",{attrs:{label:s.$t("m.Old_Email")}},[e("el-input",{attrs:{disabled:""},model:{value:s.formEmail.oldEmail,callback:function(e){s.$set(s.formEmail,"oldEmail",e)},expression:"formEmail.oldEmail"}})],1),e("el-form-item",{attrs:{label:s.$t("m.New_Email"),prop:"newEmail"}},[e("el-input",{model:{value:s.formEmail.newEmail,callback:function(e){s.$set(s.formEmail,"newEmail",e)},expression:"formEmail.newEmail"}},[e("el-button",{attrs:{slot:"append",loading:s.loading.btnSendEmail,icon:"el-icon-message"},on:{click:s.getChangeEmailCode},slot:"append"},[s._v(" "+s._s(s.$t("m.Get_Captcha"))+" ")])],1)],1),e("el-form-item",{attrs:{label:s.$t("m.Captcha"),prop:"code"}},[e("el-input",{model:{value:s.formEmail.code,callback:function(e){s.$set(s.formEmail,"code",e)},expression:"formEmail.code"}})],1)],1),e("el-popover",{attrs:{placement:"top",width:"350",trigger:"click"},model:{value:s.visible.emailSlideBlock,callback:function(e){s.$set(s.visible,"emailSlideBlock",e)},expression:"visible.emailSlideBlock"}},[e("el-button",{attrs:{slot:"reference",type:"primary",loading:s.loading.btnEmailLoading,disabled:s.disabled.btnEmail},slot:"reference"},[s._v(s._s(s.$t("m.Update_Email")))]),e("slide-verify",{directives:[{name:"show",rawName:"v-show",value:!s.verify.emailSuccess,expression:"!verify.emailSuccess"}],ref:"emailSlideBlock",attrs:{l:42,r:10,w:325,h:100,accuracy:3,imgs:s.imgs,"slider-text":s.$t("m.Slide_Verify")},on:{success:s.changeEmail,again:function(e){return s.onAgain("email")}}}),e("el-alert",{directives:[{name:"show",rawName:"v-show",value:s.verify.emailSuccess,expression:"verify.emailSuccess"}],attrs:{title:s.$t("m.Slide_Verify_Success"),type:"success",description:s.verify.emailMsg,center:!0,closable:!1,"show-icon":""}})],1)],1),e("el-alert",{directives:[{name:"show",rawName:"v-show",value:s.visible.emailAlert.show,expression:"visible.emailAlert.show"}],staticStyle:{"margin-top":"15px"},attrs:{title:s.visible.emailAlert.title,type:s.visible.emailAlert.type,description:s.visible.emailAlert.description,closable:!1,effect:"dark","show-icon":""}})],1)],1)],1)},t=[],r=(a("d9e2"),a("14d9"),a("3228")),o=a("7aa9"),l=(a("e05f"),{data(){const s=[{required:!0,trigger:"blur",message:this.$i18n.t("m.The_current_password_cannot_be_empty")},{trigger:"blur",min:6,max:20,message:this.$i18n.t("m.Password_Check_Between")}],e=(s,e,a)=>{e!==this.formPassword.newPassword&&a(new Error(this.$i18n.t("m.Password_does_not_match"))),a()},a=(s,e,a)=>{""!==this.formPassword.oldPassword&&(this.formPassword.oldPassword===this.formPassword.newPassword?a(new Error(this.$i18n.t("m.The_new_password_does_not_change"))):this.$refs.formPassword.validateField("again_password")),a()},i=(s,e,a)=>{""!==this.formEmail.oldEmail&&this.formEmail.oldEmail===this.formEmail.newEmail&&a(new Error(this.$i18n.t("m.The_new_email_does_not_change"))),a()};return{loading:{btnPassword:!1,btnEmail:!1,btnSendEmail:!1},disabled:{btnPassword:!1,btnEmail:!1},verify:{passwordSuccess:!1,passwordMsg:"",emailSuccess:!1,emailMsg:""},visible:{passwordAlert:{type:"success",show:!1,title:"",description:""},emailAlert:{type:"success",show:!1,title:"",description:""},passwordSlideBlock:!1,emailSlideBlock:!1},formPassword:{oldPassword:"",newPassword:"",againPassword:""},formEmail:{password:"",oldEmail:"",newEmail:""},rulePassword:{oldPassword:s,newPassword:[{required:!0,trigger:"blur",message:this.$i18n.t("m.The_new_password_cannot_be_empty")},{trigger:"blur",min:6,max:20,message:this.$i18n.t("m.Password_Check_Between")},{validator:a,trigger:"blur"}],againPassword:[{required:!0,trigger:"blur",message:this.$i18n.t("m.Password_Again_Check_Required")},{validator:e,trigger:"blur"}]},ruleEmail:{password:s,newEmail:[{required:!0,message:this.$i18n.t("m.Email_Check_Required"),trigger:"blur"},{type:"email",trigger:"change",message:this.$i18n.t("m.Email_Check_Format")},{validator:i,trigger:"blur"}],code:[{required:!0,message:this.$i18n.t("m.Code_Check_Required"),trigger:"blur"}]},imgs:["https://picsum.photos/325/100?random=1","https://picsum.photos/325/100?random=2","https://picsum.photos/325/100?random=3","https://picsum.photos/325/100?random=4","https://picsum.photos/325/100?random=5","https://picsum.photos/325/100?random=6","https://picsum.photos/325/100?random=7","https://picsum.photos/325/100?random=8","https://picsum.photos/325/100?random=9","https://picsum.photos/325/100?random=10"]}},mounted(){this.formEmail.oldEmail=this.$store.getters.userInfo.email||""},methods:{changePassword(s){this.verify.passwordSuccess=!0;let e=(s/1e3).toFixed(1);this.verify.passwordMsg="Total time "+e+"s",setTimeout(()=>{this.visible.passwordSlideBlock=!1,this.verify.passwordSuccess=!1,this.$refs.passwordSlideBlock.reset()},1e3),this.$refs["formPassword"].validate(s=>{if(s){this.loading.btnPassword=!0;let s=Object.assign({},this.formPassword);delete s.againPassword,r["a"].changePassword(s).then(s=>{this.loading.btnPassword=!1,200==s.data.data.code?(o["a"].success(this.$i18n.t("m.Update_Successfully")),this.visible.passwordAlert={show:!0,title:this.$i18n.t("m.Update_Successfully"),type:"success",description:s.data.data.msg},setTimeout(()=>{this.visible.passwordAlert=!1,this.$router.push({name:"Logout"})},5e3)):(o["a"].error(s.data.data.msg),this.visible.passwordAlert={show:!0,title:this.$i18n.t("m.Update_Failed"),type:"warning",description:s.data.data.msg},403==s.data.data.code&&(this.visible.passwordAlert.type="error",this.disabled.btnPassword=!0))},s=>{this.loading.btnPassword=!1})}})},getChangeEmailCode(){this.formEmail.newEmail||o["a"].error(this.$i18n.t("m.The_new_email_cannot_be_empty"));var s=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;s.test(this.formEmail.newEmail)?(this.formEmail.oldEmail===this.formEmail.newEmail&&o["a"].error(this.$i18n.t("m.The_new_email_does_not_change")),this.loading.btnSendEmail=!0,r["a"].getChangeEmailCode(this.formEmail.newEmail).then(s=>{o["a"].success(this.$i18n.t("m.Change_Send_Email_Msg")),this.$notify.success({title:this.$i18n.t("m.Success"),message:this.$i18n.t("m.Change_Send_Email_Msg"),duration:5e3,offset:50}),this.loading.btnSendEmail=!1},s=>{this.loading.btnSendEmail=!1})):mMessage.error(this.$i18n.t("m.Email_Check_Format"))},changeEmail(s){this.verify.emailSuccess=!0;let e=(s/1e3).toFixed(1);this.verify.emailMsg="Total time "+e+"s",setTimeout(()=>{this.visible.emailSlideBlock=!1,this.verify.emailSuccess=!1,this.$refs.emailSlideBlock.reset()},1e3),this.$refs["formEmail"].validate(s=>{if(s){this.loading.btnEmail=!0;let s=Object.assign({},this.formEmail);r["a"].changeEmail(s).then(s=>{this.loading.btnEmail=!1,200==s.data.data.code?(o["a"].success(this.$i18n.t("m.Update_Successfully")),this.visible.emailAlert={show:!0,title:this.$i18n.t("m.Update_Successfully"),type:"success",description:s.data.data.msg},this.$store.dispatch("setUserInfo",s.data.data.userInfo),this.$refs["formEmail"].resetFields(),this.formEmail.oldEmail=s.data.data.userInfo.email):(o["a"].error(s.data.data.msg),this.visible.emailAlert={show:!0,title:this.$i18n.t("m.Update_Failed"),type:"warning",description:s.data.data.msg},403==s.data.data.code&&(this.visible.emailAlert.type="error",this.disabled.btnEmail=!0))},s=>{this.loading.btnEmail=!1})}})},onAgain(s){"password"?this.$refs.passwordSlideBlock.reset():this.$refs.emailSlideBlock.reset(),o["a"].warning(this.$i18n.t("m.Guess_robot"))}}}),d=l,m=(a("6681"),a("2877")),n=Object(m["a"])(d,i,t,!1,null,"1a260521",null);e["default"]=n.exports},6681:function(s,e,a){"use strict";a("69a4")},"69a4":function(s,e,a){}}]);