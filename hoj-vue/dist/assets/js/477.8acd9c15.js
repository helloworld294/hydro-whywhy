"use strict";(self["webpackChunkhoj_vue"]=self["webpackChunkhoj_vue"]||[]).push([[477],{49477:function(t,e,i){i.r(e),i.d(e,{default:function(){return h}});var o=function(){var t=this,e=t._self._c;return e("div",[e("el-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("span",{staticClass:"panel-title home-title"},[t._v(t._s(t.$t("m.SysNotice")))]),e("div",{staticStyle:{"font-size":"13px","margin-top":"5px",color:"red"}},[t._v(" "+t._s(t.$t("m.Push_System_Notification_Every_Hour"))+" ")])]),e("div",{staticClass:"create"},[e("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(e){return t.openNoticeDialog(null)}}},[t._v(t._s(t.$t("m.Create")))])],1),e("div",{staticClass:"list"},[e("vxe-table",{ref:"table",attrs:{loading:t.loading,data:t.noticeList,"auto-resize":"",stripe:""}},[e("vxe-table-column",{attrs:{"min-width":"50",field:"id",title:"ID"}}),e("vxe-table-column",{attrs:{"min-width":"150",field:"title","show-overflow":"",title:t.$t("m.Notice_Title")}}),e("vxe-table-column",{attrs:{"min-width":"150",field:"gmtCreate",title:t.$t("m.Created_Time")},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(" "+t._s(t._f("localtime")(e.gmtCreate))+" ")]}}])}),e("vxe-table-column",{attrs:{"min-width":"150",field:"gmtModified",title:t.$t("m.Modified_Time")},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(" "+t._s(t._f("localtime")(e.gmtModified))+" ")]}}])}),e("vxe-table-column",{attrs:{"min-width":"150",field:"adminUsername","show-overflow":"",title:t.$t("m.Author")}}),e("vxe-table-column",{attrs:{"min-width":"100",field:"state",title:t.$t("m.Notice_Push")}}),e("vxe-table-column",{attrs:{title:t.$t("m.Option"),"min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("m.Edit_Notice"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-edit-outline",size:"mini",type:"primary"},nativeOn:{click:function(e){return t.openNoticeDialog(i.row)}}})],1),e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("m.Delete_Notice"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-delete-solid",size:"mini",type:"danger"},nativeOn:{click:function(e){return t.deleteNotice(i.row.id)}}})],1)]}}])})],1),e("div",{staticClass:"panel-options"},[e("el-pagination",{staticClass:"page",attrs:{layout:"prev, pager, next","page-size":t.pageSize,total:t.total},on:{"current-change":t.currentChange}})],1)],1)]),e("el-dialog",{attrs:{title:t.noticeDialogTitle,visible:t.showEditNoticeDialog,fullscreen:!0},on:{"update:visible":function(e){t.showEditNoticeDialog=e},open:t.onOpenEditDialog}},[e("el-form",{attrs:{"label-position":"top",model:t.notice}},[e("el-form-item",{attrs:{label:t.$t("m.Notice_Title"),required:""}},[e("el-input",{staticClass:"title-input",attrs:{placeholder:t.$t("m.Notice_Title")},model:{value:t.notice.title,callback:function(e){t.$set(t.notice,"title",e)},expression:"notice.title"}})],1),e("el-form-item",{attrs:{label:t.$t("m.Notice_Content"),required:""}},[e("Editor",{attrs:{value:t.notice.content},on:{"update:value":function(e){return t.$set(t.notice,"content",e)}}})],1),e("div",{staticClass:"visible-box"},[e("span",[t._v(t._s(t.$t("m.Notice_Recipient")))]),e("span",[e("el-radio",{attrs:{label:"All"},model:{value:t.notice.type,callback:function(e){t.$set(t.notice,"type",e)},expression:"notice.type"}},[t._v(t._s(t.$t("m.All_User")))]),e("el-radio",{attrs:{label:"Single",disabled:""},model:{value:t.notice.type,callback:function(e){t.$set(t.notice,"type",e)},expression:"notice.type"}},[t._v(t._s(t.$t("m.Designated_User")))]),e("el-radio",{attrs:{label:"Admin",disabled:""},model:{value:t.notice.type,callback:function(e){t.$set(t.notice,"type",e)},expression:"notice.type"}},[t._v(t._s(t.$t("m.All_Admin")))])],1)])],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"danger"},nativeOn:{click:function(e){t.showEditNoticeDialog=!1}}},[t._v(t._s(t.$t("m.Cancel")))]),e("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.submitNotice.apply(null,arguments)}}},[t._v(t._s(t.$t("m.OK")))])],1)],1)],1)},n=[],l=i(27328),s=i(199),a=i(50651);const c=()=>Promise.resolve().then(i.bind(i,48799));var r={name:"notice",components:{Editor:c},data(){return{contestID:"",showEditNoticeDialog:!1,noticeList:[],pageSize:10,total:0,mode:"create",notice:{id:null,title:"",content:"",type:"",adminId:""},noticeDialogTitle:"Edit Notice",loading:!1,currentPage:1}},mounted(){this.init()},methods:{init(){this.getNoticeList(1)},currentChange(t){this.currentPage=t,this.contestID?this.getContestNoticeList(t):this.getNoticeList(t)},getNoticeList(t){this.loading=!0,l.A.admin_getNoticeList(t,this.pageSize,"All").then(t=>{this.loading=!1,this.total=t.data.data.total,this.noticeList=t.data.data.records},t=>{this.loading=!1})},onOpenEditDialog(){setTimeout(()=>{if(document.createEvent){let t=document.createEvent("HTMLEvents");t.initEvent("resize",!0,!0),window.dispatchEvent(t)}else document.createEventObject&&window.fireEvent("onresize")},0)},submitNotice(t=void 0){t.id||(t=this.notice);let e="edit"===this.mode?"admin_updateNotice":"admin_createNotice",i=t;l.A[e](i).then(t=>{this.showEditNoticeDialog=!1,s.A.success(this.$i18n.t("m.Post_successfully")),this.init()}).catch()},deleteNotice(t){this.$confirm(this.$i18n.t("m.Delete_Notice_Tips"),"Warning",{confirmButtonText:this.$i18n.t("m.OK"),cancelButtonText:this.$i18n.t("m.Cancel"),type:"warning"}).then(()=>{this.loading=!0;let e="admin_deleteNotice";l.A[e](t).then(t=>{this.loading=!0,s.A.success(this.$i18n.t("m.Delete_successfully")),this.init()})}).catch(()=>{this.loading=!1})},openNoticeDialog(t){this.showEditNoticeDialog=!0,null!==t?(this.noticeDialogTitle=this.$i18n.t("m.Edit_Notice"),this.notice=Object.assign({},t),this.mode="edit"):(this.noticeDialogTitle=this.$i18n.t("m.Create_Notice"),this.notice.title="",this.notice.content="",this.notice.type="All",this.notice.adminId=this.userInfo.uid,this.mode="create")}},watch:{$route(){this.init()}},computed:{...(0,a.L8)(["userInfo"])}},d=r,u=i(37419),m=(0,u.A)(d,o,n,!1,null,"11b56160",null),h=m.exports}}]);