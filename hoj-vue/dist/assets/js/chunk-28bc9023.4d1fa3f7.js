(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28bc9023"],{"028c":function(t,e,i){"use strict";var n=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:t.$t("m.Security_Confirm"),visible:t.visible,width:"400px","close-on-click-modal":!1,"close-on-press-escape":!1,"show-close":!1},on:{"update:visible":function(e){t.visible=e}}},[e("div",{staticClass:"security-confirm-content"},[e("div",{staticClass:"warning-icon"},[e("i",{staticClass:"el-icon-warning",staticStyle:{color:"#E6A23C","font-size":"48px"}})]),e("div",{staticClass:"warning-text"},[e("h3",[t._v(t._s(t.$t("m.Security_Operation_Warning")))]),e("p",[t._v(t._s(t.operationDescription))])]),e("div",{staticClass:"password-input"},[e("el-input",{attrs:{type:"password",placeholder:t.$t("m.Enter_Security_Password"),"show-password":""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleConfirm.apply(null,arguments)}},model:{value:t.confirmPassword,callback:function(e){t.confirmPassword=e},expression:"confirmPassword"}})],1)]),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.handleCancel}},[t._v(t._s(t.$t("m.Cancel")))]),e("el-button",{attrs:{type:"danger",loading:t.loading,disabled:!t.confirmPassword},on:{click:t.handleConfirm}},[t._v(" "+t._s(t.$t("m.Confirm"))+" ")])],1)])},s=[],o=i("3228"),a={name:"SecurityConfirm",props:{visible:{type:Boolean,default:!1},operationDescription:{type:String,default:""},operationType:{type:String,default:""},operationData:{type:Object,default:()=>({})}},data(){return{confirmPassword:"",loading:!1,SECURITY_PASSWORD:"fdtfdt"}},methods:{async handleConfirm(){if(this.confirmPassword){if(this.confirmPassword!==this.SECURITY_PASSWORD)return this.$message.error(this.$i18n.t("m.Incorrect_Security_Password")),void(this.confirmPassword="");this.loading=!0;try{const t=await this.getMacAddress();await this.logSecurityOperation(t),this.$emit("confirm",{operationType:this.operationType,operationData:this.operationData,macAddress:t}),this.handleCancel(),this.$message.success(this.$i18n.t("m.Security_Operation_Confirmed"))}catch(t){console.error("Security operation failed:",t),this.$message.error(this.$i18n.t("m.Security_Operation_Failed"))}finally{this.loading=!1}}else this.$message.error(this.$i18n.t("m.Please_Enter_Password"))},handleCancel(){this.confirmPassword="",this.$emit("cancel")},async getMacAddress(){try{const t=await fetch("/api/get-mac-address");if(t.ok){const e=await t.json();return e.macAddress||"unknown"}}catch(i){console.warn("Failed to get MAC address:",i)}navigator.userAgent;const t=Date.now(),e=Math.random().toString(36).substring(2);return`client_${t}_${e}`},async logSecurityOperation(t){try{const e={operationType:this.operationType,operationData:this.operationData,macAddress:t,userAgent:navigator.userAgent,timestamp:(new Date).toISOString(),userId:this.$store.getters.userInfo.uid,username:this.$store.getters.userInfo.username};await o["a"].logSecurityOperation(e)}catch(e){console.error("Failed to log security operation:",e)}}},watch:{visible(t){t&&(this.confirmPassword="")}}},r=a,l=(i("62c5"),i("2877")),c=Object(l["a"])(r,n,s,!1,null,"6061a289",null);e["a"]=c.exports},"1cc8":function(t,e,i){"use strict";i("3723")},3723:function(t,e,i){},"3a1d":function(t,e,i){},"62c5":function(t,e,i){"use strict";i("3a1d")},"7b98":function(t,e,i){"use strict";i.r(e);var n=function(){var t=this,e=t._self._c;return e("div",[e("el-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("span",{staticClass:"panel-title home-title"},[t._v(t._s(t.$t("m.Contest_List")))]),e("div",{staticClass:"filter-row"},[e("span",[e("vxe-input",{attrs:{placeholder:t.$t("m.Enter_keyword"),type:"search",size:"medium"},on:{"search-click":t.filterByKeyword},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterByKeyword.apply(null,arguments)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1)])]),e("vxe-table",{ref:"xTable",attrs:{loading:t.loading,data:t.contestList,"auto-resize":"",stripe:"",align:"center"}},[e("vxe-table-column",{attrs:{field:"id",width:"80",title:"ID"}}),e("vxe-table-column",{attrs:{field:"title","min-width":"150",title:t.$t("m.Title"),"show-overflow":""}}),e("vxe-table-column",{attrs:{title:t.$t("m.Type"),width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-tag",{attrs:{type:"gray"}},[t._v(t._s(t._f("parseContestType")(i.type)))])]}}])}),e("vxe-table-column",{attrs:{title:t.$t("m.Auth"),width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-tooltip",{attrs:{content:t.$t("m."+t.CONTEST_TYPE_REVERSE[i.auth].tips),placement:"top",effect:"light"}},[e("el-tag",{attrs:{type:t.CONTEST_TYPE_REVERSE[i.auth].color,effect:"plain"}},[t._v(" "+t._s(t.CONTEST_TYPE_REVERSE[i.auth].name)+" ")])],1)]}}])}),e("vxe-table-column",{attrs:{title:t.$t("m.Status"),width:"100"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-tag",{attrs:{effect:"dark",color:t.CONTEST_STATUS_REVERSE[i.status].color,size:"medium"}},[t._v(" "+t._s(t.CONTEST_STATUS_REVERSE[i.status].name)+" ")])]}}])}),e("vxe-table-column",{attrs:{title:t.$t("m.Visible"),"min-width":"80"},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("el-switch",{attrs:{disabled:!t.isSuperAdmin&&t.userInfo.uid!=i.uid},on:{change:function(e){return t.changeContestVisible(i.id,i.visible,i.uid)}},model:{value:i.visible,callback:function(e){t.$set(i,"visible",e)},expression:"row.visible"}})]}}])}),e("vxe-table-column",{attrs:{"min-width":"210",title:t.$t("m.Info")},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[e("p",[t._v("Start Time: "+t._s(t._f("localtime")(i.startTime)))]),e("p",[t._v("End Time: "+t._s(t._f("localtime")(i.endTime)))]),e("p",[t._v("Created Time: "+t._s(t._f("localtime")(i.gmtCreate)))]),e("p",[t._v("Creator: "+t._s(i.author))])]}}])}),e("vxe-table-column",{attrs:{"min-width":"150",title:t.$t("m.Option")},scopedSlots:t._u([{key:"default",fn:function({row:i}){return[t.isSuperAdmin||t.userInfo.uid==i.uid?[e("div",{staticStyle:{"margin-bottom":"10px"}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("m.Edit"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-edit",size:"mini",type:"primary"},nativeOn:{click:function(e){return t.goEdit(i.id)}}})],1),e("el-tooltip",{attrs:{effect:"dark",content:t.$t("m.View_Contest_Problem_List"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-tickets",size:"mini",type:"success"},nativeOn:{click:function(e){return t.goContestProblemList(i.id)}}})],1)],1),e("div",{staticStyle:{"margin-bottom":"10px"}},[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("m.View_Contest_Announcement_List"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-info",size:"mini",type:"info"},nativeOn:{click:function(e){return t.goContestAnnouncement(i.id)}}})],1),e("el-tooltip",{attrs:{effect:"dark",content:t.$t("m.Download_Contest_AC_Submission"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-download",size:"mini",type:"warning"},nativeOn:{click:function(e){return t.openDownloadOptions(i.id)}}})],1)],1)]:t._e(),t.isSuperAdmin?e("el-tooltip",{attrs:{effect:"dark",content:t.$t("m.Delete"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-delete",size:"mini",type:"danger"},nativeOn:{click:function(e){return t.deleteContest(i.id)}}})],1):t._e()]}}])})],1),e("div",{staticClass:"panel-options"},[e("el-pagination",{staticClass:"page",attrs:{layout:"prev, pager, next","page-size":t.pageSize,"current-page":t.currentPage,total:t.total},on:{"current-change":t.currentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)],1),e("SecurityConfirm",{attrs:{visible:t.securityConfirmVisible,"operation-description":t.securityOperationDescription,"operation-type":t.securityOperationType,"operation-data":t.securityOperationData},on:{confirm:t.handleSecurityConfirm,cancel:t.handleSecurityCancel}}),e("el-dialog",{attrs:{title:t.$t("m.Download_Contest_AC_Submission"),width:"320px",visible:t.downloadDialogVisible},on:{"update:visible":function(e){t.downloadDialogVisible=e}}},[e("el-switch",{attrs:{"active-text":t.$t("m.Exclude_admin_submissions")},model:{value:t.excludeAdmin,callback:function(e){t.excludeAdmin=e},expression:"excludeAdmin"}}),e("el-radio-group",{staticStyle:{"margin-top":"10px"},model:{value:t.splitType,callback:function(e){t.splitType=e},expression:"splitType"}},[e("el-radio",{attrs:{label:"user"}},[t._v(t._s(t.$t("m.SplitType_User")))]),e("el-radio",{attrs:{label:"problem"}},[t._v(t._s(t.$t("m.SplitType_Problem")))])],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{type:"primary"},on:{click:t.downloadSubmissions}},[t._v(t._s(t.$t("m.OK")))])],1)],1)],1)},s=[],o=(i("14d9"),i("e9f5"),i("f665"),i("3228")),a=i("90b9"),r=i("9a36"),l=i("2f62"),c=i("7aa9"),d=i("028c"),u={name:"ContestList",components:{SecurityConfirm:d["a"]},data(){return{pageSize:10,total:0,contestList:[],keyword:"",loading:!1,excludeAdmin:!0,splitType:"user",currentPage:1,currentId:1,downloadDialogVisible:!1,CONTEST_TYPE_REVERSE:{},securityConfirmVisible:!1,securityOperationDescription:"",securityOperationType:"",securityOperationData:{}}},mounted(){this.CONTEST_TYPE_REVERSE=Object.assign({},r["d"]),this.CONTEST_STATUS_REVERSE=Object.assign({},r["b"]),this.getContestList(this.currentPage)},watch:{$route(){let t="true"==this.$route.query.refresh;t&&this.getContestList(1)}},computed:{...Object(l["c"])(["isSuperAdmin","userInfo"])},methods:{currentChange(t){this.currentPage=t,this.getContestList(t)},getContestList(t){this.loading=!0,o["a"].admin_getContestList(t,this.pageSize,this.keyword).then(t=>{this.loading=!1,this.total=t.data.data.total,this.contestList=t.data.data.records},t=>{this.loading=!1})},openDownloadOptions(t){this.downloadDialogVisible=!0,this.currentId=t},downloadSubmissions(){let t=`/api/file/download-contest-ac-submission?cid=${this.currentId}&excludeAdmin=${this.excludeAdmin}&splitType=${this.splitType}`;a["a"].downloadFile(t),this.downloadDialogVisible=!1},goEdit(t){this.$router.push({name:"admin-edit-contest",params:{contestId:t}})},goContestAnnouncement(t){this.$router.push({name:"admin-contest-announcement",params:{contestId:t}})},goContestProblemList(t){this.$router.push({name:"admin-contest-problem-list",params:{contestId:t}})},deleteContest(t){const e=this.contestList.find(e=>e.id===t),i=e?e.title:"ID:"+t;this.showSecurityConfirm("delete_contest","删除比赛: "+i,{contestId:t,contestTitle:i})},changeContestVisible(t,e,i){o["a"].admin_changeContestVisible(t,e,i).then(t=>{c["a"].success(this.$i18n.t("m.Update_Successfully"))})},filterByKeyword(){this.currentChange(1)},showSecurityConfirm(t,e,i){this.securityOperationType=t,this.securityOperationDescription=e,this.securityOperationData=i,this.securityConfirmVisible=!0},handleSecurityConfirm(t){switch(this.securityConfirmVisible=!1,t.operationType){case"delete_contest":this.performContestDelete(t.operationData.contestId);break;default:console.warn("Unknown security operation type:",t.operationType)}},handleSecurityCancel(){this.securityConfirmVisible=!1,this.securityOperationType="",this.securityOperationDescription="",this.securityOperationData={}},performContestDelete(t){o["a"].admin_deleteContest(t).then(t=>{c["a"].success(this.$i18n.t("m.Delete_successfully")),this.currentChange(1)})}}},p=u,m=(i("1cc8"),i("2877")),f=Object(m["a"])(p,n,s,!1,null,"42b5e010",null);e["default"]=f.exports}}]);