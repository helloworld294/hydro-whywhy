"use strict";(self["webpackChunkhoj_vue"]=self["webpackChunkhoj_vue"]||[]).push([[25],{12025:function(t,e,s){s.r(e),s.d(e,{default:function(){return d}});var i=function(){var t=this,e=t._self._c;return e("div",[e("el-card",[e("div",{attrs:{slot:"header"},slot:"header"},[e("span",{staticClass:"panel-title home-title"},[t._v(t._s(t.$t("m.Discussion_Admin")))]),e("div",{staticClass:"filter-row"},[e("span",[e("el-button",{attrs:{type:"danger",icon:"el-icon-delete-solid",size:"small"},on:{click:function(e){return t.deleteDiscussion(null)}}},[t._v(t._s(t.$t("m.Delete"))+" ")])],1),e("span",[e("vxe-input",{attrs:{placeholder:t.$t("m.Enter_keyword"),type:"search",size:"medium"},on:{"search-click":t.filterByKeyword},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.filterByKeyword.apply(null,arguments)}},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1)])]),e("vxe-table",{ref:"xTable",attrs:{stripe:"","auto-resize":"",data:t.discussionList,align:"center",loading:t.discussionLoadingTable,"checkbox-config":{highlight:!0,range:!0}},on:{"checkbox-change":t.handleSelectionChange,"checkbox-all":t.handlechangeAll}},[e("vxe-table-column",{attrs:{type:"checkbox",width:"60"}}),e("vxe-table-column",{attrs:{field:"id",title:"ID",width:"60"}}),e("vxe-table-column",{attrs:{field:"title",title:t.$t("m.Title"),"show-overflow":"","min-width":"150"}}),e("vxe-table-column",{attrs:{field:"author",title:t.$t("m.Author"),"min-width":"150","show-overflow":""}}),e("vxe-table-column",{attrs:{field:"likeNum",title:t.$t("m.Likes"),"min-width":"96"}}),e("vxe-table-column",{attrs:{field:"viewNum",title:t.$t("m.Views"),"min-width":"96"}}),e("vxe-table-column",{attrs:{field:"gmtCreate",title:t.$t("m.Created_Time"),"min-width":"150"},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(" "+t._s(t._f("localtime")(e.gmtCreate))+" ")]}}])}),e("vxe-table-column",{attrs:{field:"status",title:t.$t("m.Status"),"min-width":"100"},scopedSlots:t._u([{key:"default",fn:function({row:s}){return[e("el-select",{attrs:{size:"small"},on:{change:function(e){return t.changeDiscussionStatus(s)}},model:{value:s.status,callback:function(e){t.$set(s,"status",e)},expression:"row.status"}},[e("el-option",{key:0,attrs:{label:t.$t("m.Normal"),value:0}}),e("el-option",{key:1,attrs:{label:t.$t("m.Disable"),value:1}})],1)]}}])}),e("vxe-table-column",{attrs:{"min-width":"100",field:"topPriority",title:t.$t("m.Top")},scopedSlots:t._u([{key:"default",fn:function({row:s}){return[e("el-switch",{attrs:{"active-text":"","inactive-text":"","active-value":!0,"inactive-value":!1},on:{change:function(e){return t.handleTopSwitch(s)}},model:{value:s.topPriority,callback:function(e){t.$set(s,"topPriority",e)},expression:"row.topPriority"}})]}}])}),e("vxe-table-column",{attrs:{title:t.$t("m.Option"),"min-width":"130"},scopedSlots:t._u([{key:"default",fn:function({row:s}){return[e("el-tooltip",{attrs:{effect:"dark",content:t.$t("m.Delete"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-delete-solid",size:"mini",type:"danger"},nativeOn:{click:function(e){return t.deleteDiscussion([s.id])}}})],1),e("el-tooltip",{attrs:{effect:"dark",content:t.$t("m.View_Discussion"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-search",size:"mini",type:"primary"},nativeOn:{click:function(e){return t.toDiscussion(s.id,s.gid)}}})],1)]}}])})],1),e("div",{staticClass:"panel-options"},[e("el-pagination",{staticClass:"page",attrs:{layout:"prev, pager, next","page-size":t.pageSize,total:t.discussionTotal},on:{"current-change":t.discussionCurrentChange}})],1)],1),e("el-card",{staticStyle:{"margin-top":"20px"}},[e("div",{attrs:{slot:"header"},slot:"header"},[e("span",{staticClass:"panel-title home-title"},[t._v(t._s(t.$t("m.Discussion_Report")))])]),e("vxe-table",{ref:"table",attrs:{loading:t.discussionReportLoadingTable,align:"center",data:t.discussionReportList,"auto-resize":"",stripe:""}},[e("vxe-table-column",{attrs:{"min-width":"60",field:"id",title:"ID"}}),e("vxe-table-column",{attrs:{"min-width":"100",field:"did",title:t.$t("m.Discussion_ID")}}),e("vxe-table-column",{attrs:{field:"discussionTitle",title:t.$t("m.Title"),"show-overflow":"","min-width":"150"}}),e("vxe-table-column",{attrs:{field:"discussionAuthor",title:t.$t("m.Author"),"min-width":"150","show-overflow":""}}),e("vxe-table-column",{attrs:{"min-width":"150",field:"reporter","show-overflow":"",title:t.$t("m.Reporter")}}),e("vxe-table-column",{attrs:{"min-width":"150",field:"gmtCreate",title:t.$t("m.Report_Time")},scopedSlots:t._u([{key:"default",fn:function({row:e}){return[t._v(" "+t._s(t._f("localtime")(e.gmtCreate))+" ")]}}])}),e("vxe-table-column",{attrs:{"min-width":"100",field:"status",title:t.$t("m.Checked")},scopedSlots:t._u([{key:"default",fn:function({row:s}){return[e("el-switch",{attrs:{"active-text":"","inactive-text":"","active-value":!0,"inactive-value":!1},on:{change:function(e){return t.handleCheckedSwitch(s)}},model:{value:s.status,callback:function(e){t.$set(s,"status",e)},expression:"row.status"}})]}}])}),e("vxe-table-column",{attrs:{title:t.$t("m.Option"),"min-width":"150"},scopedSlots:t._u([{key:"default",fn:function({row:s}){return[e("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:t.$t("m.View_Report_content"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-document",size:"mini",type:"success"},nativeOn:{click:function(e){return t.openReportDialog(s.content)}}})],1),e("el-tooltip",{attrs:{effect:"dark",content:t.$t("m.View_Discussion"),placement:"top"}},[e("el-button",{attrs:{icon:"el-icon-search",size:"mini",type:"primary"},nativeOn:{click:function(e){return t.toDiscussion(s.did,s.gid)}}})],1)]}}])})],1),e("div",{staticClass:"panel-options"},[e("el-pagination",{staticClass:"page",attrs:{layout:"prev, pager, next","page-size":t.pageSize,total:t.discussionReportTotal},on:{"current-change":t.discussionReportCurrentChange}})],1)],1)],1)},n=[],o=(s(52093),s(27328)),a=s(199),l={name:"discussion",data(){return{pageSize:10,discussionTotal:0,discussionList:[],selectedDiscussions:[],keyword:"",discussionLoadingTable:!1,discussionCurrentPage:1,discussionReportList:[],discussionReportTotal:0,discussionReportCurrentPage:1,discussionReportLoadingTable:!1}},mounted(){this.getDiscussionList(1),this.getDiscussionReportList()},methods:{discussionCurrentChange(t){this.discussionCurrentPage=t,this.getDiscussionList(t)},discussionReportCurrentChange(t){this.discussionReportCurrentPage=t,this.getDiscussionReportList()},getDiscussionList(t){this.discussionLoadingTable=!0;let e={currentPage:t,keyword:this.keyword,admin:!0};o.A.getDiscussionList(this.pageSize,e).then(t=>{this.discussionLoadingTable=!1,this.discussionTotal=t.data.data.total,this.discussionList=t.data.data.records},t=>{this.discussionLoadingTable=!1})},getDiscussionReportList(){this.discussionReportLoadingTable=!0,o.A.admin_getDiscussionReport(this.discussionReportCurrentPage,this.pageSize).then(t=>{this.discussionReportLoadingTable=!1,this.discussionReportList=t.data.data.records,this.discussionReportTotal=t.data.data.total},t=>{this.discussionReportLoadingTable=!1})},filterByKeyword(){this.discussionCurrentChange(1),this.keyword=""},handleSelectionChange({records:t}){this.selectedDiscussions=[];for(let e=0;e<t.length;e++)this.selectedDiscussions.push(t[e].id)},handlechangeAll(){let t=this.$refs.xTable.getCheckboxRecords();this.selectedDiscussions=[];for(let e=0;e<t.length;e++)this.selectedDiscussions.push(t[e].id)},changeDiscussionStatus(t){let e={id:t.id,status:t.status};o.A.admin_updateDiscussion(e).then(t=>{a.A.success(this.$i18n.t("m.Update_Successfully"))})},handleTopSwitch(t){let e={id:t.id,topPriority:t.topPriority};o.A.admin_updateDiscussion(e).then(t=>{a.A.success(this.$i18n.t("m.Update_Successfully"))})},handleCheckedSwitch(t){let e={id:t.id,status:t.status};o.A.admin_updateDiscussionReport(e).then(t=>{a.A.success(this.$i18n.t("m.Update_Successfully"))})},toDiscussion(t,e){null!=e?window.open("/group/"+e+"/discussion-detail/"+t):window.open("/discussion-detail/"+t)},deleteDiscussion(t){t||(t=this.selectedDiscussions),t.length>0?this.$confirm(this.$i18n.t("m.Delete_Discussion_Tips"),"Tips",{type:"warning"}).then(()=>{o.A.admin_deleteDiscussion(t).then(t=>{a.A.success(this.$i18n.t("m.Delete_successfully")),this.selectedDiscussions=[],this.getDiscussionList(this.currentPage)}).catch(()=>{this.selectedDiscussions=[],this.getDiscussionList(this.currentPage)})},()=>{}):a.A.warning(this.$i18n.t("m.The_number_of_discussions_selected_cannot_be_empty"))},openReportDialog(t){let e,s="#(.*?)# ",i=RegExp(s,"g"),n="<strong>"+this.$i18n.t("m.Tags")+"</strong>：";while(e=i.exec(t))n+=e[1]+" ";n+="<br><br><strong>"+this.$i18n.t("m.Content")+"</strong>："+t.replace(/#(.*?)# /g,""),this.$alert(n,this.$i18n.t("m.Report_Content"),{confirmButtonText:this.$i18n.t("m.OK"),dangerouslyUseHTMLString:!0})}}},c=l,r=s(37419),u=(0,r.A)(c,i,n,!1,null,"05905c02",null),d=u.exports}}]);