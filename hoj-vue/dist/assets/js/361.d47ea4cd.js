"use strict";(self["webpackChunkhoj_vue"]=self["webpackChunkhoj_vue"]||[]).push([[361],{10361:function(e,t,i){i.r(t),i.d(t,{default:function(){return b}});var n=function(){var e=this,t=e._self._c;return t("div",[t("el-card",[t("div",{attrs:{slot:"header"},slot:"header"},[t("span",{staticClass:"panel-title home-title"},[e._v(e._s(e.$t("m.Training_Problem_List")))]),t("div",{staticClass:"filter-row"},[t("span",[t("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:function(t){e.addProblemDialogVisible=!0}}},[e._v(e._s(e.$t("m.Add_From_Public_Problem"))+" ")])],1),t("span",[t("el-button",{attrs:{type:"success",size:"small",icon:"el-icon-plus"},on:{click:function(t){e.AddRemoteOJProblemDialogVisible=!0}}},[e._v(e._s(e.$t("m.Add_Rmote_OJ_Problem"))+" ")])],1),t("span",[t("vxe-input",{attrs:{placeholder:e.$t("m.Enter_keyword"),type:"search",size:"medium"},on:{"search-click":e.filterByKeyword},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterByKeyword.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}})],1)])]),t("vxe-table",{ref:"adminProblemList",attrs:{stripe:"","auto-resize":"",data:e.problemList,loading:e.loading,align:"center"}},[t("vxe-table-column",{attrs:{"min-width":"64",field:"id",title:"ID"}}),t("vxe-table-column",{attrs:{"min-width":"100",field:"problemId",title:e.$t("m.Display_ID")}}),t("vxe-table-column",{attrs:{field:"title","min-width":"150",title:e.$t("m.Title"),"show-overflow":""}}),t("vxe-table-column",{attrs:{field:"author","min-width":"100",title:e.$t("m.Author"),"show-overflow":""}}),t("vxe-table-column",{attrs:{"min-width":"200",title:e.$t("m.Training_Problem_Rank")},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-input-number",{attrs:{min:0,max:2147483647},on:{change:function(t){return e.handleChangeRank(e.trainingProblemMap[i.id])}},model:{value:e.trainingProblemMap[i.id].rank,callback:function(t){e.$set(e.trainingProblemMap[i.id],"rank",t)},expression:"trainingProblemMap[row.id].rank"}})]}}])}),t("vxe-table-column",{attrs:{"min-width":"120",title:e.$t("m.Auth")},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-select",{attrs:{disabled:!e.isSuperAdmin&&!e.isProblemAdmin,size:"small"},on:{change:function(t){return e.changeProblemAuth(i)}},model:{value:i.auth,callback:function(t){e.$set(i,"auth",t)},expression:"row.auth"}},[t("el-option",{attrs:{label:e.$t("m.Public_Problem"),value:1,disabled:!e.isSuperAdmin&&!e.isProblemAdmin}}),t("el-option",{attrs:{label:e.$t("m.Private_Problem"),value:2}}),t("el-option",{attrs:{label:e.$t("m.Contest_Problem"),value:3,disabled:!0}})],1)]}}])}),t("vxe-table-column",{attrs:{title:"Option","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[e.isSuperAdmin||e.isProblemAdmin||i.author==e.userInfo.username?t("el-tooltip",{attrs:{effect:"dark",content:e.$t("m.Edit"),placement:"top"}},[t("el-button",{attrs:{icon:"el-icon-edit-outline",size:"mini",type:"primary"},nativeOn:{click:function(t){return e.goEdit(i.id)}}})],1):e._e(),e.isSuperAdmin||e.isProblemAdmin?t("el-tooltip",{attrs:{effect:"dark",content:e.$t("m.Download_Testcase"),placement:"top"}},[t("el-button",{attrs:{icon:"el-icon-download",size:"mini",type:"success"},nativeOn:{click:function(t){return e.downloadTestCase(i.id)}}})],1):e._e(),t("el-tooltip",{attrs:{effect:"dark",content:e.$t("m.Remove"),placement:"top"}},[t("el-button",{attrs:{icon:"el-icon-close",size:"mini",type:"warning"},nativeOn:{click:function(t){return e.removeProblem(i.id)}}})],1),e.isSuperAdmin||e.isProblemAdmin?t("el-tooltip",{attrs:{effect:"dark",content:e.$t("m.Delete"),placement:"top"}},[t("el-button",{attrs:{icon:"el-icon-delete-solid",size:"mini",type:"danger"},nativeOn:{click:function(t){return e.deleteProblem(i.id)}}})],1):e._e()]}}])})],1),t("div",{staticClass:"panel-options"},[t("el-pagination",{staticClass:"page",attrs:{layout:"prev, pager, next, sizes","page-size":e.pageSize,total:e.total,"page-sizes":[10,30,50,100]},on:{"current-change":e.currentChange,"size-change":e.onPageSizeChange}})],1)],1),t("el-dialog",{attrs:{title:e.$t("m.Add_Training_Problem"),width:"90%",visible:e.addProblemDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addProblemDialogVisible=t}}},[t("AddPublicProblem",{attrs:{trainingID:e.trainingId},on:{"on-change":e.getProblemList}})],1),t("el-dialog",{attrs:{title:e.$t("m.Add_Rmote_OJ_Problem"),width:"350px",visible:e.AddRemoteOJProblemDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.AddRemoteOJProblemDialogVisible=t}}},[t("el-form",[t("el-form-item",{attrs:{label:e.$t("m.Remote_OJ")}},[t("el-select",{attrs:{size:"small"},model:{value:e.otherOJName,callback:function(t){e.otherOJName=t},expression:"otherOJName"}},e._l(e.REMOTE_OJ,function(e,i){return t("el-option",{key:i,attrs:{label:e.name,value:e.key}})}),1)],1),t("el-form-item",{attrs:{label:e.$t("m.Problem_ID"),required:""}},[t("el-input",{attrs:{size:"small"},model:{value:e.otherOJProblemId,callback:function(t){e.otherOJProblemId=t},expression:"otherOJProblemId"}})],1),t("el-form-item",{staticStyle:{"text-align":"center"}},[t("el-button",{attrs:{type:"primary",icon:"el-icon-plus",loading:e.addRemoteOJproblemLoading},on:{click:e.addRemoteOJProblem}},[e._v(e._s(e.$t("m.Add"))+" ")])],1)],1)],1)],1)},l=[],o=(i(52093),i(27328)),a=i(42443),r=i(199),s=i(97889),d=i(50651),m=i(15637),c={name:"ProblemList",components:{AddPublicProblem:a.A},data(){return{problemListAuth:0,oj:"All",pageSize:10,total:0,problemList:[],trainingProblemMap:{},keyword:"",loading:!1,currentPage:1,routeName:"",trainingId:"",currentProblemID:"",currentRow:{},addProblemDialogVisible:!1,AddRemoteOJProblemDialogVisible:!1,addRemoteOJproblemLoading:!1,otherOJName:"HDU",otherOJProblemId:"",REMOTE_OJ:{},displayId:""}},mounted(){this.init()},computed:{...(0,d.L8)(["userInfo","isSuperAdmin","isProblemAdmin"])},methods:{init(){this.routeName=this.$route.name,this.trainingId=this.$route.params.trainingId,this.getProblemList(this.currentPage),this.REMOTE_OJ=Object.assign({},s.Hd)},goEdit(e){this.$router.push({name:"admin-edit-problem",params:{problemId:e}})},currentChange(e){this.currentPage=e,this.getProblemList(e)},onPageSizeChange(e){this.pageSize=e,this.getProblemList(this.currentPage)},getProblemList(e=1){this.loading=!0;let t={limit:this.pageSize,currentPage:e,keyword:this.keyword,tid:this.trainingId,queryExisted:!0};0!=this.problemListAuth&&(t["auth"]=this.problemListAuth),o.A.admin_getTrainingProblemList(t).then(e=>{this.loading=!1,this.total=e.data.data.problemList.total,this.problemList=e.data.data.problemList.records,this.trainingProblemMap=e.data.data.trainingProblemMap},e=>{this.loading=!1})},handleChangeRank(e){o.A.admin_updateTrainingProblem(e).then(e=>{r.A.success(this.$i18n.t("m.Update_Successfully")),this.getProblemList(1)})},changeProblemAuth(e){o.A.admin_changeProblemAuth(e).then(e=>{r.A.success(this.$i18n.t("m.Update_Successfully"))})},deleteProblem(e){this.$confirm(this.$i18n.t("m.Delete_Problem_Tips"),"Tips",{type:"warning"}).then(()=>{o.A.admin_deleteTrainingProblem(e,null).then(e=>{r.A.success(this.$i18n.t("m.Delete_successfully")),this.getProblemList(this.currentPage)}).catch(()=>{})},()=>{})},removeProblem(e){this.$confirm(this.$i18n.t("m.Remove_Training_Problem_Tips"),"Tips",{type:"warning"}).then(()=>{o.A.admin_deleteTrainingProblem(e,this.trainingId).then(e=>{r.A.success("success"),this.getProblemList(this.currentPage)}).catch(()=>{})},()=>{})},downloadTestCase(e){let t="/api/file/download-testcase?pid="+e;m.A.downloadFile(t).then(()=>{this.$alert(this.$i18n.t("m.Download_Testcase_Success"),"Tips")})},filterByKeyword(){this.currentChange(1)},addRemoteOJProblem(){this.otherOJProblemId?(this.addRemoteOJproblemLoading=!0,o.A.admin_addTrainingRemoteOJProblem(this.otherOJName,this.otherOJProblemId,this.trainingId).then(e=>{this.addRemoteOJproblemLoading=!1,this.AddRemoteOJProblemDialogVisible=!1,r.A.success(this.$i18n.t("m.Add_Successfully")),this.currentChange(1)},e=>{this.addRemoteOJproblemLoading=!1})):r.A.error(this.$i18n.t("m.Problem_ID_is_required"))}},watch:{$route(e,t){e.params.trainingId==t.params.trainingId&&e.name==t.name||this.init()}}},u=c,h=i(37419),p=(0,h.A)(u,n,l,!1,null,"71a09eac",null),b=p.exports},42443:function(e,t,i){i.d(t,{A:function(){return c}});var n=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"text-align":"center"}},[void 0!=e.contest.type?t("div",{staticStyle:{"margin-bottom":"10px"}},[t("span",{staticClass:"tips"},[e._v(e._s(0==e.contest.type?e.$t("m.ACM_Contest_Add_From_Public_Problem_Tips"):e.$t("m.OI_Contest_Add_From_Public_Problem_Tips")))])]):e._e(),t("vxe-input",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:e.$t("m.Enter_keyword"),type:"search",size:"medium"},on:{"search-click":e.filterByKeyword},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.filterByKeyword.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}}),t("vxe-table",{attrs:{data:e.problems,loading:e.loading,"auto-resize":"",stripe:"",align:"center"}},[t("vxe-table-column",{attrs:{title:"ID","min-width":"100",field:"problemId"}}),t("vxe-table-column",{attrs:{"min-width":"150",title:e.$t("m.Title"),field:"title"}}),t("vxe-table-column",{attrs:{title:e.$t("m.Option"),align:"center","min-width":"100"},scopedSlots:e._u([{key:"default",fn:function({row:i}){return[t("el-tooltip",{attrs:{effect:"dark",content:e.$t("m.Add"),placement:"top"}},[t("el-button",{attrs:{icon:"el-icon-plus",size:"mini",type:"primary"},nativeOn:{click:function(t){return e.handleAddProblem(i.id,i.problemId)}}})],1)]}}])})],1),t("el-pagination",{staticClass:"page",attrs:{layout:"prev, pager, next","page-size":e.limit,"current-page":e.page,total:e.total},on:{"current-change":e.getPublicProblem,"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t}}})],1)},l=[],o=i(27328),a=i(199),r={name:"add-problem-from-public",props:["contestID","trainingID"],data(){return{page:1,limit:10,total:0,loading:!1,problems:[],contest:{},keyword:""}},mounted(){this.contestID?o.A.admin_getContest(this.contestID).then(e=>{this.contest=e.data.data,this.getPublicProblem(1)}).catch(()=>{}):this.trainingID&&this.getPublicProblem(1)},methods:{getPublicProblem(e){this.loading=!0;let t={keyword:this.keyword,currentPage:e,limit:this.limit,problemType:this.contest.type,cid:this.contest.id,tid:this.trainingID},i=null;this.contestID?i="admin_getContestProblemList":this.trainingID&&(i="admin_getTrainingProblemList"),o.A[i](t).then(e=>{this.loading=!1,this.total=e.data.data.problemList.total,this.problems=e.data.data.problemList.records}).catch(()=>{this.loading=!1})},handleAddProblem(e,t){if(this.contestID)this.$prompt(this.$i18n.t("m.Enter_The_Problem_Display_ID_in_the_Contest"),"Tips").then(({value:t})=>{let i={pid:e,cid:this.contestID,displayId:t};o.A.admin_addContestProblemFromPublic(i).then(e=>{this.$emit("on-change"),a.A.success(this.$i18n.t("m.Add_Successfully")),this.getPublicProblem(this.page)},()=>{})},()=>{});else{let i={pid:e,tid:this.trainingID,displayId:t};o.A.admin_addTrainingProblemFromPublic(i).then(e=>{this.$emit("on-change"),a.A.success(this.$i18n.t("m.Add_Successfully")),this.getPublicProblem(this.page)},()=>{})}},filterByKeyword(){this.page=1,this.getPublicProblem(this.page)}}},s=r,d=i(37419),m=(0,d.A)(s,n,l,!1,null,"2c306d64",null),c=m.exports}}]);